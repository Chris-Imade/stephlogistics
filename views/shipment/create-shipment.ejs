<div class="create-shipment-container">
  <div class="container">
    <div class="card">
      <div class="card-header" style="padding-top: 10rem">
        <h2>Create Your Shipment</h2>
        <p>Complete the form below to set up your package delivery</p>
      </div>
      <div class="card-body">
        <div class="progress-container">
          <div class="progress-bar">
            <div class="progress" id="progress-bar"></div>
          </div>
          <div class="progress-steps">
            <div class="progress-step active" data-step="1">
              <div class="progress-step-icon">1</div>
              <div class="progress-step-label">Customer Info</div>
            </div>
            <div class="progress-step" data-step="2">
              <div class="progress-step-icon">2</div>
              <div class="progress-step-label">Addresses</div>
            </div>
            <div class="progress-step" data-step="3">
              <div class="progress-step-icon">3</div>
              <div class="progress-step-label">Package Details</div>
            </div>
            <div class="progress-step" data-step="4">
              <div class="progress-step-icon">4</div>
              <div class="progress-step-label">Shipping Options</div>
            </div>
            <div class="progress-step" data-step="5">
              <div class="progress-step-icon">5</div>
              <div class="progress-step-label">Payment</div>
            </div>
          </div>
        </div>

        <div id="toast-container" class="toast-container"></div>

        <form id="shipment-form">
          <!-- Step 1: Customer Information -->
          <div id="step-1" class="step-form active">
            <h3 class="section-heading">Customer Information</h3>
            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="first-name" class="form-label">First Name</label>
                  <input
                    type="text"
                    id="first-name"
                    name="first-name"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <label for="last-name" class="form-label">Last Name</label>
                  <input
                    type="text"
                    id="last-name"
                    name="last-name"
                    class="form-control"
                    required
                  />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="email" class="form-label">Email Address</label>
              <input
                type="email"
                id="email"
                name="email"
                class="form-control"
                required
              />
            </div>
            <div class="form-group">
              <label for="phone" class="form-label">Phone Number</label>
              <input
                type="tel"
                id="phone"
                name="phone"
                class="form-control"
                placeholder="+44 7700 900000"
                required
              />
            </div>
            <div class="form-group">
              <label for="company" class="form-label"
                >Company Name (Optional)</label
              >
              <input
                type="text"
                id="company"
                name="company"
                class="form-control"
              />
            </div>
            <div class="form-group">
              <label for="reference" class="form-label"
                >Order Reference (Optional)</label
              >
              <input
                type="text"
                id="reference"
                name="reference"
                class="form-control"
                placeholder="Your internal reference number"
              />
            </div>
            <div class="btn-group">
              <div></div>
              <!-- Empty div for flex spacing -->
              <button type="button" class="btn btn-primary" id="btn-step-1">
                Continue <span class="icon">→</span>
              </button>
            </div>
          </div>

          <!-- Step 2: Shipment Addresses -->
          <div id="step-2" class="step-form">
            <h3 class="section-heading">Shipment Addresses</h3>

            <h4 class="subsection-heading">Origin Address</h4>
            <div class="form-group">
              <label for="origin-address" class="form-label"
                >Street Address</label
              >
              <input
                type="text"
                id="origin-address"
                name="origin-address"
                class="form-control"
                required
              />
            </div>
            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="origin-city" class="form-label">City</label>
                  <input
                    type="text"
                    id="origin-city"
                    name="origin-city"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <label for="origin-postal-code" class="form-label"
                    >Postal Code</label
                  >
                  <input
                    type="text"
                    id="origin-postal-code"
                    name="origin-postal-code"
                    class="form-control"
                    required
                  />
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="origin-state" class="form-label"
                    >State/Province/Region</label
                  >
                  <input
                    type="text"
                    id="origin-state"
                    name="origin-state"
                    class="form-control"
                  />
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <label for="origin-country" class="form-label">Country</label>
                  <select
                    id="origin-country"
                    name="origin-country"
                    class="form-select"
                    required
                  >
                    <option value="">Select Country</option>
                    <option value="GB">United Kingdom</option>
                    <option value="US">United States</option>
                    <option value="CA">Canada</option>
                    <option value="AU">Australia</option>
                    <option value="DE">Germany</option>
                    <option value="FR">France</option>
                    <option value="IT">Italy</option>
                    <option value="ES">Spain</option>
                    <option value="JP">Japan</option>
                    <option value="CN">China</option>
                  </select>
                </div>
              </div>
            </div>

            <h4 class="subsection-heading">Destination Address</h4>
            <div class="form-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="same-as-origin"
                  name="same-as-origin"
                />
                <label class="form-check-label" for="same-as-origin"
                  >Same as origin address</label
                >
              </div>
            </div>
            <div id="destination-address-fields">
              <div class="form-group">
                <label for="destination-address" class="form-label"
                  >Street Address</label
                >
                <input
                  type="text"
                  id="destination-address"
                  name="destination-address"
                  class="form-control"
                  required
                />
              </div>
              <div class="form-row">
                <div class="form-col">
                  <div class="form-group">
                    <label for="destination-city" class="form-label"
                      >City</label
                    >
                    <input
                      type="text"
                      id="destination-city"
                      name="destination-city"
                      class="form-control"
                      required
                    />
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-group">
                    <label for="destination-postal-code" class="form-label"
                      >Postal Code</label
                    >
                    <input
                      type="text"
                      id="destination-postal-code"
                      name="destination-postal-code"
                      class="form-control"
                      required
                    />
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-col">
                  <div class="form-group">
                    <label for="destination-state" class="form-label"
                      >State/Province/Region</label
                    >
                    <input
                      type="text"
                      id="destination-state"
                      name="destination-state"
                      class="form-control"
                    />
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-group">
                    <label for="destination-country" class="form-label"
                      >Country</label
                    >
                    <select
                      id="destination-country"
                      name="destination-country"
                      class="form-select"
                      required
                    >
                      <option value="">Select Country</option>
                      <option value="GB">United Kingdom</option>
                      <option value="US">United States</option>
                      <option value="CA">Canada</option>
                      <option value="AU">Australia</option>
                      <option value="DE">Germany</option>
                      <option value="FR">France</option>
                      <option value="IT">Italy</option>
                      <option value="ES">Spain</option>
                      <option value="JP">Japan</option>
                      <option value="CN">China</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="btn-group">
              <button type="button" class="btn btn-outline" id="btn-back-1">
                <span class="icon">←</span> Back
              </button>
              <button type="button" class="btn btn-primary" id="btn-step-2">
                Continue <span class="icon">→</span>
              </button>
            </div>
          </div>

          <!-- Step 3: Package Information -->
          <div id="step-3" class="step-form">
            <h3 class="section-heading">Package Information</h3>
            <div class="form-group">
              <label for="package-type" class="form-label">Package Type</label>
              <select
                id="package-type"
                name="package-type"
                class="form-select"
                required
              >
                <option value="">Select Package Type</option>
                <option value="envelope">Envelope</option>
                <option value="small-package">Small Package</option>
                <option value="medium-package">Medium Package</option>
                <option value="large-package">Large Package</option>
                <option value="pallet">Pallet</option>
              </select>
            </div>
            <div class="form-group">
              <label for="weight" class="form-label">Weight (kg)</label>
              <input
                type="number"
                id="weight"
                name="weight"
                class="form-control"
                step="0.1"
                min="0.1"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label">Dimensions (cm)</label>
              <div class="form-row">
                <div class="form-col">
                  <input
                    type="number"
                    id="length"
                    name="length"
                    class="form-control"
                    placeholder="Length"
                    step="0.1"
                    min="0.1"
                    required
                  />
                </div>
                <div class="form-col">
                  <input
                    type="number"
                    id="width"
                    name="width"
                    class="form-control"
                    placeholder="Width"
                    step="0.1"
                    min="0.1"
                    required
                  />
                </div>
                <div class="form-col">
                  <input
                    type="number"
                    id="height"
                    name="height"
                    class="form-control"
                    placeholder="Height"
                    step="0.1"
                    min="0.1"
                    required
                  />
                </div>
              </div>
            </div>

            <h4 class="subsection-heading">Package Contents</h4>
            <div class="form-group">
              <label for="contents" class="form-label"
                >Description of Contents</label
              >
              <textarea
                id="contents"
                name="contents"
                class="form-control"
                rows="3"
                required
              ></textarea>
            </div>

            <div class="form-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="fragile"
                  name="fragile"
                />
                <label class="form-check-label" for="fragile"
                  >This shipment contains fragile items</label
                >
              </div>
            </div>
            <div class="form-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="insurance"
                  name="insurance"
                />
                <label class="form-check-label" for="insurance"
                  >Add shipping insurance (recommended)</label
                >
              </div>
            </div>
            <div id="insurance-value-group" class="form-group hidden">
              <label for="declared-value" class="form-label"
                >Declared Value (£)</label
              >
              <input
                type="number"
                id="declared-value"
                name="declared-value"
                class="form-control"
                step="0.01"
                min="1"
              />
            </div>

            <div class="btn-group">
              <button type="button" class="btn btn-outline" id="btn-back-2">
                <span class="icon">←</span> Back
              </button>
              <button type="button" class="btn btn-primary" id="btn-step-3">
                Continue <span class="icon">→</span>
              </button>
            </div>
          </div>

          <!-- Step 4: Shipping Options -->
          <div id="step-4" class="step-form">
            <h3 class="section-heading">Shipping Options</h3>
            <p>Select your preferred carrier:</p>

            <div class="shipping-options">
              <div class="shipping-option" data-option="ups">
                <input
                  type="radio"
                  id="shipping-ups"
                  name="shipping-method"
                  value="ups"
                  data-price="45.95"
                  required
                />
                <div class="option-details">
                  <h4>UPS <span class="price">£45.95</span></h4>
                  <p>Reliable international shipping</p>
                  <p>Full tracking and signature on delivery</p>
                </div>
              </div>

              <div class="shipping-option" data-option="fedex">
                <input
                  type="radio"
                  id="shipping-fedex"
                  name="shipping-method"
                  value="fedex"
                  data-price="58.50"
                  required
                />
                <div class="option-details">
                  <h4>FedEx <span class="price">£58.50</span></h4>
                  <p>Fast worldwide delivery</p>
                  <p>Real-time tracking updates</p>
                </div>
              </div>

              <div class="shipping-option" data-option="dhl">
                <input
                  type="radio"
                  id="shipping-dhl"
                  name="shipping-method"
                  value="dhl"
                  data-price="52.75"
                  required
                />
                <div class="option-details">
                  <h4>DHL <span class="price">£52.75</span></h4>
                  <p>Global express shipping network</p>
                  <p>Premium tracking included</p>
                </div>
              </div>
            </div>

            <div class="form-group mt-3">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="saturday-delivery"
                  name="saturday-delivery"
                  data-price="12.50"
                />
                <label class="form-check-label" for="saturday-delivery"
                  >Add Saturday Delivery (+£12.50)</label
                >
              </div>
            </div>

            <div class="btn-group">
              <button type="button" class="btn btn-outline" id="btn-back-3">
                <span class="icon">←</span> Back
              </button>
              <button type="button" class="btn btn-primary" id="btn-step-4">
                Continue <span class="icon">→</span>
              </button>
            </div>
          </div>

          <!-- Step 5: Payment Method -->
          <div id="step-5" class="step-form">
            <h3 class="section-heading">Payment Method</h3>
            <div id="payment-method-options">
              <p>Select your preferred payment method:</p>
              <div class="payment-buttons">
                <button type="button" class="payment-btn" id="stripe-button">
                  <span class="spinner"></span>
                  <span class="button-text"
                    ><i class="fab fa-stripe"></i> Stripe</span
                  >
                </button>
                <button type="button" class="payment-btn" id="paypal-btn">
                  <i class="fab fa-paypal"></i> PayPal
                </button>
              </div>
              <input
                type="hidden"
                id="payment-method"
                name="payment-method"
                value=""
              />
            </div>

            <!-- Payment Details -->
            <div id="payment-details-container" style="display: none">
              <!-- Stripe Elements will be inserted here -->
              <div id="payment-element"></div>
              <div
                id="payment-status"
                style="color: red; margin-top: 10px"
              ></div>
              <div id="paypal-button-container" style="display: none">
                <div
                  class="paypal-container w-100"
                  style="min-height: 200px"
                ></div>
              </div>
              <div id="payment-error" class="payment-error"></div>
            </div>

            <div class="btn-group">
              <button type="button" class="btn btn-secondary" id="btn-back-4">
                <span class="icon">←</span> Back
              </button>
              <!-- Stripe submit button will be shown only when Stripe is selected -->
              <button type="button" class="btn btn-primary" id="submit-stripe-payment" style="display: none;">
                <span class="spinner"></span>
                <span class="button-text">Confirm Payment</span>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Your custom JS -->
<script src="/assets/js/shipment-form.js"></script>

<% if (typeof locals.extraJS !== 'undefined') { %> <%- locals.extraJS %> <% } %>
